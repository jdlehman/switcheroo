var switcheroo = (function(t, e) {
  'use strict';
  function n(t) {
    var e = decodeURI(window.location[t].slice(1).split('?')[0]);
    return '/' !== e.charAt(0) ? '/' + e : e;
  }
  function a(t) {
    return '/' === t ? t : '/' !== t.slice(-1) ? t : t.slice(0, -1);
  }
  function r(t) {
    return t.replace(/\/:[^\/]+/g, '/([^/]+)');
  }
  function o(t) {
    return (t.match(/:[^\/]+/g) || []).map(function(t) {
      return t.substr(1);
    });
  }
  function i(t, e) {
    return r(a(t + e) + '/?');
  }
  function s(t) {
    return new RegExp('^(' + t.join('|') + ')$');
  }
  function h(e, n) {
    var r = n.children, o = n.basePath, h = a(e);
    return (
      t.Children.toArray(r).filter(function(t) {
        return s(
          [].concat(t.props.path).map(function(t) {
            return i(o, t);
          })
        ).test(h);
      })[0] || null
    );
  }
  function c(t, e, n) {
    if (!n) return null;
    var r = a(t);
    return (
      [].concat(n.props.path).filter(function(t) {
        var n = i(e, t);
        return new RegExp('^' + n + '$').test(r);
      })[0] || null
    );
  }
  function u(t, e, n) {
    var r = {}, s = a(t);
    return n &&
      [].concat(n.props.path).forEach(function(t) {
        var n = o(e + t), a = i(e, t), h = s.match(new RegExp('^' + a + '$'));
        h &&
          (h.shift(), n.forEach(function(t, e) {
            r[t] = h[e];
          }));
      }), r;
  }
  function p(t, e) {
    if (!(t instanceof e))
      throw new TypeError('Cannot call a class as a function');
  }
  function l(t, e) {
    if (!t)
      throw new ReferenceError(
        "this hasn't been initialised - super() hasn't been called"
      );
    return !e || ('object' != typeof e && 'function' != typeof e) ? t : e;
  }
  function f(t, e) {
    if ('function' != typeof e && null !== e)
      throw new TypeError(
        'Super expression must either be null or a function, not ' + typeof e
      );
    (t.prototype = Object.create(e && e.prototype, {
      constructor: { value: t, enumerable: !1, writable: !0, configurable: !0 }
    })), e &&
      (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : (t.__proto__ = e));
  }
  var d = 'default' in t ? t.default : t;
  e = 'default' in e ? e.default : e;
  var v =
    Object.assign ||
    function(t) {
      for (var e = 1; e < arguments.length; e++) {
        var n = arguments[e];
        for (var a in n)
          Object.prototype.hasOwnProperty.call(n, a) && (t[a] = n[a]);
      }
      return t;
    },
    w = (function() {
      function t(t, e) {
        for (var n = 0; n < e.length; n++) {
          var a = e[n];
          (a.enumerable = a.enumerable || !1), (a.configurable = !0), 'value' in
            a && (a.writable = !0), Object.defineProperty(t, a.key, a);
        }
      }
      return function(e, n, a) {
        return n && t(e.prototype, n), a && t(e, a), e;
      };
    })(),
    y = (function(t) {
      function e(t) {
        p(this, e);
        var a = l(
          this,
          (e.__proto__ || Object.getPrototypeOf(e)).call(this, t)
        );
        b.call(a);
        var r = n(t.location),
          o = h(r, t),
          i = c(r, t.basePath, o),
          s = u(r, t.basePath, o);
        return (a.state = {
          visibleSwitch: o,
          dynamicValues: s,
          activePath: i
        }), a;
      }
      return f(e, t), w(e, [
        {
          key: 'componentDidMount',
          value: function() {
            this.props.load &&
              window.addEventListener('load', this.handleRouteChange), this
              .props.pushState &&
              window.addEventListener('popstate', this.handleRouteChange), this
              .props.hashChange &&
              window.addEventListener('hashchange', this.handleRouteChange);
          }
        },
        {
          key: 'componentWillReceiveProps',
          value: function(t) {
            this.handleSwitchChange(t);
          }
        },
        {
          key: 'shouldComponentUpdate',
          value: function(t) {
            return !t.preventUpdate();
          }
        },
        {
          key: 'componentWillUnmount',
          value: function() {
            this.props.load &&
              window.removeEventListener('load', this.handleRouteChange), this
              .props.pushState &&
              window.removeEventListener(
                'popstate',
                this.handleRouteChange
              ), this.props.hashChange &&
              window.removeEventListener('hashchange', this.handleRouteChange);
          }
        },
        {
          key: 'render',
          value: function() {
            var t = this.state.visibleSwitch || {},
              n = t.props,
              a =
                this.state.visibleSwitch &&
                d.cloneElement(
                  this.state.visibleSwitch,
                  v(
                    {},
                    n,
                    this.props.mapDynamicSegments(this.state.dynamicValues),
                    { activePath: this.state.activePath }
                  )
                );
            if (this.props.renderSwitch)
              return this.props.renderSwitch(
                a,
                this.state.dynamicValues,
                this.state.activePath
              );
            if (this.props.wrapper) {
              var r = v({}, this.props);
              return Object.keys(e.propTypes).forEach(function(t) {
                return delete r[t];
              }), d.createElement(this.props.wrapper, r, a);
            }
            return a;
          }
        }
      ]), e;
    })(t.Component);
  (y.displayName = 'Switcher'), (y.propTypes = {
    children: e.oneOfType([e.arrayOf(e.node), e.node]),
    pushState: e.bool,
    hashChange: e.bool,
    load: e.bool,
    onChange: e.func,
    wrapper: e.any,
    location: e.string,
    basePath: e.string,
    preventUpdate: e.func,
    mapDynamicSegments: e.func,
    renderSwitch: e.func
  }), (y.defaultProps = {
    pushState: !1,
    hashChange: !0,
    load: !0,
    location: 'hash',
    basePath: '',
    preventUpdate: function() {
      return !1;
    },
    mapDynamicSegments: function(t) {
      return t;
    }
  });
  var b = function() {
    var t = this;
    (this.handleSwitchChange = function(e) {
      var a = n(e.location),
        r = h(a, e),
        o = c(a, e.basePath, r),
        i = u(a, e.basePath, r);
      'function' == typeof e.onChange && e.onChange(!!r, a, i, o), t.setState({
        visibleSwitch: r,
        dynamicValues: i,
        activePath: o
      });
    }), (this.handleRouteChange = function(e) {
      t.handleSwitchChange(t.props);
    });
  };
  return y;
})(React, PropTypes);
